/*
	@license Angular TreeWidget version 1.0.1
	ⓒ 2016 Alex Suleap https://github.com/AlexSuleap/agular-tree-widget
	License: MIT
*/
!function(e){"use strict";e.module("TreeWidget",["ngAnimate","RecursionHelper"]).directive("tree",function(){return{restrict:"E",scope:{nodes:"=",options:"=?"},template:"<treenode nodes='nodes' tree='nodelist' options='options'></treenode>",compile:function(e,n,o){return{pre:function(e){function n(o,t){if(void 0!=o&&o.length>0)for(var d=0;d<o.length;d++){var i=o[d];void 0===i.nodeId&&(i.nodeId="tree-node-"+e.count,e.count++),void 0===i.expanded&&void 0!=i.children&&(i.expanded=!0),void 0!=t&&(i.parentId=t.nodeId),-1==e.nodelist.indexOf(i)&&e.nodelist.push(i),n(i.children,i)}}e.nodelist=[],e.options=e.options||(e.options={showIcon:!0,expandOnClick:!1,multipleSelect:!1}),e.count=0,e.$watch(function(){n(e.nodes)})}}}}}).filter("nodeFilter",["$filter",function(n){return function(o,t){var d=function(o,t){var i=[];return e.forEach(o,function(o){if(n("filter")([o],t).length>0)i.push(o);else if(e.isArray(o.children)&&o.children.length>0){var l=d(o.children,t);l.length>0&&i.push(o)}}),i};return d(o,t)}}]).directive("treenode",["RecursionHelper",function(n){return{restrict:"E",scope:{nodes:"=",tree:"=",options:"=?"},template:'<ul><li ng-repeat="node in nodes | nodeFilter:options.filter" class="node"><i class="tree-node-ico pointer" ng-class="{\'tree-node-expanded\': node.expanded && (node.children | nodeFilter:options.filter).length > 0,\'tree-node-collapsed\':!node.expanded && (node.children | nodeFilter:options.filter).length > 0}" ng-click="toggleNode(node)"></i><span class="node-title pointer" ng-click="selectNode(node, $event)" ng-class="{\'disabled\':node.disabled}"><span><i class="tree-node-ico" ng-if="options.showIcon" ng-class="{\'tree-node-image\':node.children, \'tree-node-leaf\':!node.children}" ng-style="node.image && {\'background-image\':\'url(\'+node.image+\')\'}"></i><span class="node-name" ng-class="{selected: node.selected&& !node.disabled}">{{node.name}}</span></span></span><treenode ng-if="node.children" nodes=\'node.children\' tree="tree" options="options" ng-show="node.expanded" id="{{node.nodeId}}"></treenode></li></ul>',compile:function(o){return n.compile(o,function(n,o,t,d,i){function l(o){e.forEach(n.tree,function(e){o!=e&&(e.selected=!1)})}function s(){return n.tree.filter(function(e){return e.selected})}n.selectNode=function(e,o){if(!e.disabled){var t;n.options.multipleSelect===!0?(e.selected=!e.selected,t=s()):"ctrlKey"===n.options.multipleSelect||"altKey"===n.options.multipleSelect?(o[n.options.multipleSelect]?e.selected=!e.selected:(e.selected=!0,l(e)),t=s()):(e.selected=!0,l(e),t=e),n.$emit("selection-changed",t),n.options.onSelectNode&&n.options.onSelectNode(t),n.options.expandOnClick&&void 0!=e.children&&(e.expanded=!e.expanded,n.$emit("expanded-state-changed",e),n.options.onExpandNode&&n.options.onExpandNode(e))}},n.toggleNode=function(e){void 0!=e.children&&(e.expanded=!e.expanded,n.$emit("expanded-state-changed",e),n.options.onExpandNode&&n.options.onExpandNode(e))}})}}}])}(angular);